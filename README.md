# microprocessor10
# ثنا اکبری
# جلسه دهم ریزپردازنده و زبان های اسمبلی 
# کار با ماژول بلوتوث و ماتریس ال ای دی
**MaxMatrix**
این برنامه برای کنترل یک ماتریس LED هشت‌درهشت نوشته شده و با استفاده از کتابخانه MaxMatrix می‌تواند نقطه‌ها و ستون‌های مختلف را روی نمایشگر روشن کند. در بخش راه‌اندازی، ماتریس مقداردهی اولیه می‌شود و شدت نور آن روی مقدار متوسط قرار می‌گیرد تا LEDها با روشنایی مناسبی ظاهر شوند.

در حلقه اصلی، برنامه به ترتیب چند الگوی ساده را روی ماتریس نمایش می‌دهد. ابتدا نقطه‌ای در مختصات صفر و هفت روشن می‌شود؛ یعنی دقیقاً گوشه پایین سمت چپ ماتریس. بعد از آن یک ثانیه مکث وجود دارد و سپس نقطه دیگری در مختصات هفت و صفر یعنی گوشه بالا سمت راست ظاهر می‌شود. این دو مرحله باعث می‌شود کاربر دو نقطه روشن‌شده در دو گوشه مخالف ماتریس را ببیند.

در ادامه، برنامه وارد نمایش الگوهای ستونی می‌شود. ابتدا ستون شماره سه با الگوی باینری 11110000 روشن می‌شود که نتیجه آن روشن بودن چهار LED بالایی و خاموش بودن چهار LED پایینی این ستون است. پس از یک ثانیه، ستون چهار با الگوی برعکس یعنی چهار LED پایین روشن و چهار LED بالا خاموش نمایش داده می‌شود. این دو ستون کنار هم حالتی مشابه یک خط عمودی دو‌قسمتی ایجاد می‌کنند.

در نهایت، با دستور clear کل ماتریس پاک می‌شود تا LEDها خاموش شوند و یک ثانیه مکث ایجاد می‌شود. این روند به صورت مداوم تکرار می‌شود و در هر بار، شکل‌هایی ساده و قابل تشخیص مثل نقطه در گوشه‌ها و نوار عمودی نصفه‌روشن روی ماتریس ظاهر می‌گردد.
مشاهده کد:

مشاهده شماتیک:
<img width="923" height="720" alt="led_matrix" src="https://github.com/user-attachments/assets/347cb21f-faa9-49f4-b730-a61fdd5c5382" />

مشاهده خروجی:


Uploading document_5893097182000586247.mp4…



 **MaxMatrix2**
در این برنامه از یک ماتریس LED هشت‌درهشت استفاده شده و با کمک کتابخانه MaxMatrix چند شکلک مختلف روی نمایشگر ظاهر می‌شود. هر شکلک با یک آرایه بایتی تعریف شده که در واقع همان نقشه‌ی پیکسل‌های ماتریس است. دو عدد اولِ هر آرایه نشان می‌دهد که اندازه تصویر هشت در هشت است و بقیه مقادیر، خطوط افقی ماتریس را مشخص می‌کنند. با توجه به این داده‌ها، ماتریس می‌تواند نقطه‌های لازم را روشن یا خاموش کند و شکل‌ها را بسازد.

در ابتدا ماتریس مقداردهی اولیه می‌شود و شدت نور آن در حد متوسط قرار می‌گیرد. بعد از آن، برنامه وارد حلقه‌ی اصلی می‌شود و اولین شکلک یعنی smile را نمایش می‌دهد؛ این همان شکلک خندان است که دو چشم و دهانی منحنی دارد. بعد از یک ثانیه، ماتریس پاک می‌شود و شکلک poker ساخته می‌شود که حالتی معمولی و بدون واکنش دارد. سپس دوباره ماتریس خالی می‌شود و شکلک sad نمایش داده می‌شود که دهان آن حالتی رو به پایین دارد و حالت ناراحتی را نشان می‌دهد. بعد از آن، شکلک kiss نمایان می‌شود که دهان جمع‌شده و حالتی شبیه بوسه دارد.

پس از نمایش چهار شکلک، برنامه وارد مرحله حرکت می‌شود. در این بخش، محتوای ماتریس هشت بار به سمت چپ شیفت پیدا می‌کند و این کار با یک مکث کوتاه انجام می‌شود. نتیجه این است که شکل نمایش‌داده‌شده به آرامی به سمت چپ حرکت می‌کند و کم‌کم از صفحه خارج می‌شود. بعد از آن، ماتریس یک‌بار دیگر پاک می‌شود و چرخه از ابتدا تکرار می‌شود. این روند باعث می‌شود مجموعه‌ای از شکلک‌ها یکی پس از دیگری روی ماتریس ظاهر شوند و در پایان نیز با یک حرکت نرم از صفحه خارج شوند.
مشاهده کد:

مشاهده شماتیک:

مشاهده خروجی:




**HC_05**
در این برنامه ارتباط سریال بین آردوینو و ماژول بلوتوث HC-06 برقرار شده تا بتوان از طریق یک اپلیکیشن مثل **BT Terminal** روی گوشی، داده‌ها را دریافت و ارسال کرد. از آن‌جایی که HC-06 برای ارتباط سریال نیاز به پایه‌های RX و TX دارد و معمولاً نمی‌خواهیم از پورت سریال اصلی آردوینو استفاده کنیم، از کتابخانه SoftwareSerial استفاده شده تا یک پورت سریال نرم‌افزاری روی پایه‌های ۱۰ و ۱۱ ساخته شود. پایه ۱۰ نقش دریافت (RX) و پایه ۱۱ نقش ارسال (TX) را دارد.

در بخش راه‌اندازی، ارتباط سریال اصلی آردوینو روی 9600 تنظیم شده تا بتوان داده‌ها را روی مانیتور سریال مشاهده کرد. بعد از آن، پورت سریال نرم‌افزاری نیز روی همان سرعت راه‌اندازی می‌شود تا سرعت تبادل داده بین ماژول بلوتوث و آردوینو هماهنگ باشد.

در حلقه اصلی، برنامه دائماً بررسی می‌کند که آیا داده‌ای از طرف ماژول بلوتوث دریافت شده یا نه. اگر داده‌ای وارد شود، همان لحظه بدون تغییر مستقیماً به سریال اصلی ارسال می‌شود تا در مانیتور سریال کامپیوتر قابل مشاهده باشد. به همین صورت، اگر در مانیتور سریال کامپیوتر چیزی تایپ شود، برنامه آن را می‌خواند و به ماژول HC-06 ارسال می‌کند. نتیجه این است که آردوینو بین مانیتور سریال و گوشی نقش یک پل ارتباطی یا همان رابط دوطرفه را بازی می‌کند.

در عمل، با اجرای این برنامه و باز کردن اپلیکیشن BT Terminal روی گوشی، هر چیزی که در گوشی ارسال شود روی مانیتور سریال دیده می‌شود و هر چیزی که در مانیتور سریال تایپ شود برای گوشی فرستاده خواهد شد. این روش پایه‌ای‌ترین شکل ارتباط بلوتوث با آردوینو است و معمولاً در پروژه‌های کنترل بی‌سیم یا ارسال داده استفاده می‌شود.
مشاهده کد:

مشاهده شماتیک:

مشاهده خروجی:

**HC_05 & LED**
در این برنامه یک ارتباط ساده با ماژول بلوتوث **HC-06** برقرار شده و هدف این است که با ارسال عدد صفر یا یک از طریق اپلیکیشن بلوتوث در گوشی، بتوان یک LED را روشن و خاموش کرد. پایه‌های ۱۰ و ۱۱ به‌عنوان RX و TX برای ارتباط سریال نرم‌افزاری در نظر گرفته شده‌اند تا ماژول HC-06 بدون درگیر شدن پورت سریال اصلی بتواند با آردوینو تبادل داده داشته باشد.

در بخش راه‌اندازی، ابتدا ارتباط سریال اصلی روی 9600 فعال می‌شود تا هر اتفاقی بتواند در مانیتور سریال نمایش داده شود. سپس پورت سریال مخصوص بلوتوث نیز با همان سرعت شروع به کار می‌کند. یک LED روی پایه ۱۳ تعریف شده و در خروجی قرار می‌گیرد. همچنین در ابتدای کار پیامی روی مانیتور سریال چاپ می‌شود که نشان می‌دهد ماژول آماده اتصال است و گذرواژه پیش‌فرض HC-06 معمولاً ۱۲۳۴ یا ۰۰۰۰ است.

در حلقه اصلی، برنامه منتظر می‌ماند تا اگر از سمت بلوتوث داده‌ای برسد، آن را به‌صورت یک کاراکتر در متغیر flag ذخیره کند. این مقدار می‌تواند هر چیزی باشد، اما در این برنامه فقط دو مقدار برای ما اهمیت دارد: صفر و یک. وقتی کاربر از طریق اپلیکیشن عدد یک را ارسال کند، مقدار flag برابر '1' می‌شود و برنامه LED را روشن کرده و در سریال پیام «LED On» ارسال می‌کند. اگر مقدار دریافت‌شده صفر باشد، LED خاموش می‌شود و پیام «LED Off» روی سریال دیده می‌شود.

در نتیجه، این برنامه یک کنترل از راه دور بسیار ساده برای LED فراهم می‌کند. فقط کافی است گوشی به ماژول HC-06 متصل شود و در اپلیکیشن BT Terminal کاراکتر 0 یا 1 ارسال شود. با این روش می‌شود به‌سادگی پروژه‌های ابتدایی بلوتوث را ساخت و مفاهیم پایه‌ای کنترل بی‌سیم را یاد گرفت.
مشاهده کد:

مشاهده شماتیک:

مشاهده خروجی:



